<!DOCTYPE html>
<html>
<head>
  <title>Agnodice</title>
</head>
<style>
table {
  border-collapse: collapse;
}
table, td, th {
  border: 1px solid black;
}
.highlight {
  /*font-weight: bold;*/
  background-color: rgba(255, 153, 0,.31);
}
</style>
<body>
<h1>Agnodice</h1>

<p>Busca: <input type="text" id="txt1" onkeyup="showHint(this.value)"></p>

<p><span id="txtHint"></span></p> 


<script>
terms = new Array(4);
terms[0] = getTerms("codes.txt");
terms[1] = getTerms("terms.la");
terms[2] = getTerms("terms.en");
terms[3] = getTerms("terms.es");
function showHint(str) {
  var list = "";
  if (str.length > 0) {
    //var reg = "(" + str + ")(?![^<]*>|[^<>]*</)";
    var regex = new RegExp(str, "i");
    var line;
    var res;
    var startpos;
    var endpos;
    var text;
    list = "<table>";
    list += "<tr><th>Code</th><th>Latim</th><th>English</th><th>Spa&ntilde;ol</th></tr>";
    for (var i=0; i<terms[0].length; i++) {
      line = "<tr><td>"+terms[0][i]+"</td><td>"+terms[1][i]+"</td><td>"+terms[2][i]+"</td><td>"+terms[3][i]+"</td></tr>";
      res = line.match(regex);
      if (res){
        startpos = res.index;
        endpos = startpos + res[0].toString().length;
        text = line.substring(startpos, endpos);
        list += line.replace(regex, `<spam class="highlight">${text}</spam>`);
      }
    }
    list += "</table>";
  }
  document.getElementById("txtHint").innerHTML = list;
}
function getTerms(file){
  xhttp = new XMLHttpRequest();
  xhttp.open("GET", file, false);
  xhttp.send();
  return xhttp.responseText.split('\n');
}
</script>

</body>
</html>
